<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Career Guidance Bot - DreamDegree</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .chat-container {
      height: 600px;
      overflow-y: auto;
      scroll-behavior: smooth;
    }
    
    .message {
      margin-bottom: 1rem;
      animation: fadeIn 0.3s ease-in;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .typing-indicator {
      display: none;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .typing-dots {
      display: flex;
      align-items: center;
      justify-content: center;
      space-x: 1;
    }
    
    .typing-dots span {
      height: 8px;
      width: 8px;
      background-color: #9ca3af;
      border-radius: 50%;
      display: inline-block;
      margin: 0 2px;
      animation: typing 1.4s infinite ease-in-out;
    }
    
    .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
    .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
    
    @keyframes typing {
      0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
      40% { transform: scale(1); opacity: 1; }
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .bot-message {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .user-message {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    
    .chat-input:focus {
      outline: none;
      ring: 2px;
      ring-blue-500;
      border-color: #3b82f6;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <div class="gradient-bg text-white py-8">
    <div class="max-w-4xl mx-auto px-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-3xl font-bold mb-2">Career Guidance Bot</h1>
          <p class="text-lg opacity-90">Your personal AI career advisor</p>
        </div>
        <a href="/dashboard" class="inline-flex items-center bg-white text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          Back to Dashboard
        </a>
      </div>
    </div>
  </div>

  <!-- Chat Interface -->
  <div class="max-w-4xl mx-auto px-6 py-8">
    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
      <!-- Chat Header -->
      <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-4">
        <div class="flex items-center">
          <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-3">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
          </div>
          <div>
            <h3 class="font-semibold">Career Guidance Expert</h3>
            <p class="text-sm opacity-80">Ask me anything about careers, education, and your future!</p>
          </div>
        </div>
      </div>

      <!-- Chat Messages -->
      <div id="chatContainer" class="chat-container p-6 bg-gray-50">
        <!-- Welcome Message -->
        <div class="message">
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bot-message rounded-full flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
            </div>
            <div class="bot-message text-white p-4 rounded-lg rounded-tl-none max-w-md">
              <p class="text-sm">Hello! I'm your Career Guidance Expert. I'm here to help you navigate your career path, choose the right education, and make informed decisions about your future. What would you like to know about your career journey?</p>
            </div>
          </div>
        </div>
        
        <!-- Typing Indicator -->
        <div id="typingIndicator" class="typing-indicator">
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bot-message rounded-full flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
            </div>
            <div class="bg-white p-4 rounded-lg rounded-tl-none border">
              <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chat Input -->
      <div class="border-t bg-white p-4">
        <div class="flex space-x-3">
          <input 
            type="text" 
            id="messageInput" 
            placeholder="Ask about career paths, skills needed, job prospects, education requirements..." 
            class="chat-input flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            onkeypress="handleKeyPress(event)"
          >
          <button 
            onclick="sendMessage()" 
            class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"
            id="sendButton"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
            </svg>
            <span>Send</span>
          </button>
        </div>
        
        <!-- Quick Questions -->
        <div class="mt-4">
          <p class="text-sm text-gray-600 mb-2">Quick questions to get started:</p>
          <div class="flex flex-wrap gap-2">
            <button onclick="askQuickQuestion('What career is best for me based on my interests?')" class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm hover:bg-blue-200 transition-colors">
              Career matching
            </button>
            <button onclick="askQuickQuestion('What skills do I need for software engineering?')" class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm hover:bg-green-200 transition-colors">
              Skills needed
            </button>
            <button onclick="askQuickQuestion('Should I pursue engineering or medical field?')" class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm hover:bg-purple-200 transition-colors">
              Field comparison
            </button>
            <button onclick="askQuickQuestion('What are the job prospects in AI and machine learning?')" class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm hover:bg-orange-200 transition-colors">
              Job prospects
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let isWaiting = false;

    function handleKeyPress(event) {
      if (event.key === 'Enter') {
        sendMessage();
      }
    }

    function askQuickQuestion(question) {
      document.getElementById('messageInput').value = question;
      sendMessage();
    }

    function addMessage(content, isUser = false) {
      const chatContainer = document.getElementById('chatContainer');
      const messageDiv = document.createElement('div');
      messageDiv.className = 'message';
      
      if (isUser) {
        messageDiv.innerHTML = `
          <div class="flex items-start space-x-3 justify-end">
            <div class="user-message text-white p-4 rounded-lg rounded-tr-none max-w-md">
              <p class="text-sm">${content}</p>
            </div>
            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </div>
          </div>
        `;
      } else {
        messageDiv.innerHTML = `
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bot-message rounded-full flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
            </div>
            <div class="bot-message text-white p-4 rounded-lg rounded-tl-none max-w-md">
              <p class="text-sm">${content}</p>
            </div>
          </div>
        `;
      }
      
      chatContainer.appendChild(messageDiv);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function showTypingIndicator() {
      document.getElementById('typingIndicator').style.display = 'flex';
      document.getElementById('chatContainer').scrollTop = document.getElementById('chatContainer').scrollHeight;
    }

    function hideTypingIndicator() {
      document.getElementById('typingIndicator').style.display = 'none';
    }

    async function sendMessage() {
      if (isWaiting) return;
      
      const messageInput = document.getElementById('messageInput');
      const sendButton = document.getElementById('sendButton');
      const message = messageInput.value.trim();
      
      if (!message) return;
      
      // Add user message
      addMessage(message, true);
      messageInput.value = '';
      
      // Disable input and show loading
      isWaiting = true;
      sendButton.disabled = true;
      messageInput.disabled = true;
      showTypingIndicator();
      
      try {
        const response = await fetch('/career-guidance', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ message: message })
        });
        
        const data = await response.json();
        
        hideTypingIndicator();
        
        if (data.success) {
          addMessage(data.response);
        } else {
          addMessage('Sorry, I encountered an error. Please try again later.');
        }
      } catch (error) {
        hideTypingIndicator();
        addMessage('Sorry, I encountered a connection error. Please check your internet connection and try again.');
        console.error('Error:', error);
      } finally {
        // Re-enable input
        isWaiting = false;
        sendButton.disabled = false;
        messageInput.disabled = false;
        messageInput.focus();
      }
    }

    // Focus on input when page loads
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('messageInput').focus();
    });
  </script>
</body>
</html>